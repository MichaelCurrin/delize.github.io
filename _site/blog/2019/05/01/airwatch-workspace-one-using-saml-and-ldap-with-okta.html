<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Airwatch/Workspace ONE - Using SAML and LDAP with Okta</title>
<meta name="description" content="" />
<meta name="keywords" content="" />
<meta name="author" content="Andrew Doering" />
<meta name="ROBOTS" content="">
        <!--  FavIcon  -->
<link rel="apple-touch-icon" sizes="180x180" href=/assets/favicon//apple-touch-icon.png >
<link rel="icon" type="image/png" sizes="32x32" href=/assets/favicon//favicon-32x32.png>
<link rel="icon" type="image/png" sizes="16x16" href=/assets/favicon//favicon-16x16.png>
<link rel="manifest" href=/assets/favicon/site.webmanifest>

<!-- Google Fonts -->
<link async rel="stylesheet" href="https://fonts.googleapis.com/css?family=Muli:300,400,600%7CPoppins:400,500,600,700" />

<!--  Bootstrap CSS  -->
<!-- <link rel="stylesheet" href=/assets/css/bootstrap.css > -->
<link rel="stylesheet" href=/assets/css/bootstrap.min.css >
<!--  Line Icon CSS  -->
<link rel="stylesheet" href=/assets/css/LineIcons.css>
<!--  Font Awesome CSS  -->
<link async rel="stylesheet" href=/assets/css/all.min.css />
<!-- <link rel="stylesheet" href=/assets/css/font-awesome.min.css> -->
<!--  Animate CSS  -->
<link rel="stylesheet" href=/assets/css/animate.css> 
<!--  Magnific Popup CSS  -->
<link rel="stylesheet" href=/assets/css/magnific-popup.css>
<!--  Owl-carousel CSS  -->
<link rel="stylesheet" href=/assets/css/owl.carousel.min.css>
<!--  Custom Style CSS  -->
<link rel="stylesheet" href=assets/css/style.css>

        <!--  Custom Style CSS  -->
<link rel="stylesheet" href=/assets/css/style-blog.css>
    </head>

    <body data-spy="scroll" data-target="#scrollspy" data-offset="61" class="uone-dark pt-hero">

                <!--  Pre Loader  -->
        <div id="overlayer"></div>
        <span class="loader"></span>
        <!--    Header Start    -->
<header id="header" class="header page-header bg-white fixed-top">
    <nav id="scrollspy" class="navbar navbar-expand-lg header-nav">
        <div class="container">
            <a class="navbar-brand font-weight-bold text-dark" href="http://127.0.0.1:4000">Airwatch/Workspace ONE - Using SAML and LDAP with Okta</span></a>
            <!--  Navbar Toggler Button Start -->
            <button class="navbar-toggler collapsed" type="button" data-toggle="collapse" data-target="#toggle-menu" aria-controls="toggle-menu" aria-expanded="false" aria-label="Toggle navigation">
                <span class="lni-menu size-md"></span>
            </button>
            <!--  Navbar Toggler Button End -->
            <div class="collapse navbar-collapse" id="toggle-menu">
                <ul class="navbar-nav nav-pills ml-auto">
                    <li class="nav-item">
                        <a class="nav-link text-dark" onclick="goBack()" href="javascript:void(0)">Back</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</header>
<!--    Header End    -->
        <!--    Header End    -->

        <!--    Hero Start    -->
        <section class="hero page-hero py-6" id="hero">
            <div class="text-center hero-content mx-auto">
                <h1 class="text-white mb-4 margin="4 px">Airwatch/Workspace ONE - Using SAML and LDAP with Okta</h1>
                <p class="mx-auto text-white">
                    <a href="http://127.0.0.1:4000" class="text-white">Home</a>
                    /
                    <a href="http://127.0.0.1:4000/blog" class="text-white">Blog</a>
                    /
                    <span class="text-white">Airwatch/Workspace ONE - Using SAML and LDAP with Okta</span>
                </p>
            </div>
        </section>
        <!--    Hero End    -->

        <!--   Blog-single   Start -->
        <section class="py-6">
            <div class="container">
                <div class="row">
                    <div class="col-lg-10 offset-lg-1 blog">
                        <div class="rounded px-lg-5">
                            <div class="text-md-left">
                                <h4 class="mb-4">Airwatch/Workspace ONE - Using SAML and LDAP with Okta</h4>
                                <img src="" alt="" class="img-fluid w-100 rounded">
                                <span class="d-inline-block py-4"> 2019-05-01 21:15:00 -0700
                                        / By <span class="purple-color text-right"> Andrew Doering. </span>
                                        </span>
                                <p class="link-"><p>**UPDATE 12/22/2019 - **Please see<a href="https://andrewdoering.org/blog/2019/12/22/workspace-one-okta-users-and-groups-working-with-dep-enrollment/"> this post</a> for a more up to date and more functionaly guide. It is good to read this first, before doing the other one however to get a better understanding of our initial decisions.</p>

<p>In this writeup, I will go over the configuration settings that I used, and worked with Airwatch/Workspace ONE Professional Services and Support  to get Airwatch up and working within ThousandEyes. Initially, before writing this guide (which I have admittedly been putting off for a while - since May when we did our deployment of the service), the documents that were available on VMware’s website, were mostly incorrect. This might have been fixed, however I have not gone back to validate any of their documentation. Once we spend the time to do this, I will update either this page, or create a new posting.</p>

<h2 id="precursor">Precursor</h2>

<h3 id="software-requirements">Software Requirements</h3>

<ul>
  <li>Airwatch Cloud Connector (optional)</li>
  <li>Okta Ldap Interface</li>
  <li>Okta (duh)</li>
  <li>Airwatch / Workspace One (duh)</li>
</ul>

<h3 id="initial-expectations">Initial Expectations</h3>

<p>ThousandEyes has not yet made the transition to a full cloud based Directory System, we are still using Active Directory On-Premise. However, all systems that have been deployed going from 2019 - forward, need to or should be setup in a compatible way so that when we make the full cloud transition, it is seamless. As such, we assume here that you have or are using:</p>

<ul>
  <li>Active Directory On Premise (as Profile Master in Okta)</li>
  <li>Okta (as secondary)</li>
  <li>Intent to put BambooHR as Profile Master later on</li>
  <li>Intent to move Active Directory On Premise to Azure AD</li>
</ul>

<p>We actually tried using VMware’s Identity Manager to perform SAML, but at the time, the directions did not allow configuration after following the guides provided by Okta or VMware. Because they said this was the easier way, and unfortunately when asking them - they wouldn’t bother helping us with the correct way. In addition, originally their documentation that was listed here, was incredibly wrong. It seems like in the time that I have taken to put off writing this guide, they have updated their documentation to show the correct way to connect Okta as an LDAP service.</p>

<p>Documentation <a href="https://kb.vmware.com/s/article/2961230?lang=en_US">listed here</a>, gives you a proper configuration guide. However, at the time of originally writing this guide, the documetation was incorrect and did not work.</p>

<p>With that said, I would also highly recommmend to ignore <a href="https://www.okta.com/sites/default/files/Okta-3rd-Party-UEM-Interop_Workspace-ONE.pdf">this guide</a>, it is outdated for newer versions of Workspace One.</p>

<p>So with this in mind, let me explain how ThousandEyes did this:</p>

<h2 id="workspace-one---directory-services-integration">Workspace One - Directory Services Integration</h2>

<p>Setting this portion up is quite easy with the way that the support team and consultant recommended. Unfortunately, the easy way is not the best way, and you should be able to get assistance from support easily on how to do this. However, this is how ThousandEyes has performed this:</p>

<p><img src="https://andrewdoering.org/blog/wp-content/uploads/2019/11/image.png" alt="" />LDAP Connection Settings</p>

<p>To edit any of the settings for a currently working directory, just replace the strings that are in capital letters below with yours.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;code&gt;Directory Type: Other LDAP
Server: YOURDOMAINHERE.ldap.okta.com
Encryption Type: SSL
Verify SSL Certificate: Check the box
Bind Authentication Type: Basic
Bind User Name: uid=YOURSUPERUSERHERE,dc=YOURDOMAINHERE,dc=okta,dc=com
Bind Password: YOURSECRETHERE
Domain: YOURDOMAINHERE.okta.com&lt;/code&gt;
</code></pre></div></div>

<p>This should allow you to verify or test the connection below. Once the LDAP Settings are working, move on to the User tab.</p>

<h2 id="okta-profile-mapping">Okta Profile Mapping</h2>

<p>Because we want to integrate this with Azure later on, and Active Directory, we need to map some of our existing attributes from Active Directory and push them into Okta.</p>

<p>First, go here:  <a href="https://YOURDOMAIN-admin.okta.com/admin/universaldirectory">https://YOURDOMAIN-admin.okta.com/admin/universaldirectory</a> and select the Profile button located below</p>

<p><img src="https://andrewdoering.org/blog/wp-content/uploads/2019/11/image-4-1024x201.png" alt="" /></p>

<p>Click the add attribute button</p>

<p><img src="https://andrewdoering.org/blog/wp-content/uploads/2019/11/image-5.png" alt="" /></p>

<p>Use the the following settings for the Attributes</p>

<p><img src="https://andrewdoering.org/blog/wp-content/uploads/2019/11/image-2-1024x734.png" alt="" /></p>

<p><img src="https://andrewdoering.org/blog/wp-content/uploads/2019/11/image-3-1024x734.png" alt="" /></p>

<p>Now, lets go to Active Directory’s mapping, select your domain to setup the mapping push. You want to push from the Active Directory Domain to Okta.</p>

<p><img src="https://andrewdoering.org/blog/wp-content/uploads/2019/11/image-6-1024x330.png" alt="" /></p>

<h2 id="airwatch---user-and-groups-directory-integration">Airwatch - User and Groups Directory Integration</h2>

<h3 id="users">Users</h3>

<p>Setting up the users panel</p>

<p><img src="https://andrewdoering.org/blog/wp-content/uploads/2019/11/image-1-1024x346.png" alt="" /></p>

<p>While VMware’s documentation states to use mail=, I found that for the ease of the employee, using their shorthand account name is far easier for the experience - specifically for macOS. With Windows, this change may cause problems.</p>

<p>Drop the advanced menu down and select the following features</p>

<p><img src="https://andrewdoering.org/blog/wp-content/uploads/2019/11/image-7.png" alt="" /></p>

<p>We came to the conclusion of using the following settings for the advanced section of the user system</p>

<p><img src="https://andrewdoering.org/blog/wp-content/uploads/2019/11/image-8-955x1024.png" alt="" /></p>

<p>The reasons for these attributes being used are based directly on the attributes that are listed in Profile attributes in Okta, as well, as the ldapsearch tool based on the information below:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;code&gt;ldapsearch -H ldaps://thousandeyes.ldap.okta.com -b "dc=thousandeyes,dc=okta,dc=com" -D "uid=adoering@thousandeyes.com,dc=thousandeyes,dc=okta,dc=com" -W -x "(sn=Doer)"
# extended LDIF
#
# LDAPv3
# base &lt;dc=thousandeyes,dc=okta,dc=com&gt; with scope subtree
# filter: (sn=Doer)
# requesting: ALL
#

# atesting@thousandeyes.com, users, thousandeyes.okta.com
dn: uid=atesting@thousandeyes.com,ou=users,dc=thousandeyes,dc=okta,dc=com
objectClass: top
objectClass: person
objectClass: organizationalPerson
objectClass: inetOrgPerson
uid: atesting@thousandeyes.com
uniqueIdentifier: REMOVINGFROMHERE
organizationalStatus: ACTIVE
givenName: Andrew
sn: Doer
cn: Andrew Doer
mail: atesting@thousandeyes.com
mail: atesting+testing@thousandeyes.com
AD_ObjectGUID: REMOVINGFROMHERE
sAMAccountName: atesting
title: IT Tester
department: Engineering

# search result
search: 2
result: 0 Success

# numResponses: 2
# numEntries: 1&lt;/code&gt;
</code></pre></div></div>

<p>When we look  at this, we see there are a few differences in Okta’s LDAP directories compared to Active Directory. So those adjustments are made into the above attributes. A few of these attribute changes are not mentioned in VMware’s documentations.</p>

<h3 id="groups">Groups</h3>

<p>With groups, we came to the conclusion that the following attributes were required for use within Airwatch:</p>

<p><img src="https://andrewdoering.org/blog/wp-content/uploads/2019/11/image-10-1024x493.png" alt="" /></p>

<p><img src="https://andrewdoering.org/blog/wp-content/uploads/2019/11/image-9-1024x814.png" alt="" /></p>

<p>Unfortunately, even with this setup - Airwatch does not support importing users from the groups itself. While this might be an issue only we have, I have not found a way around getting the users imported - even with the proper settings. While we have opened up a support ticket for this (and even had confirmation in the past that this was a bug), 6 months later it is still not fixed. See the Room for Improvements section for a feature request using VMware’s new feature request option.</p>

<h2 id="okta---saml-app-for-airwatch">OKTA - SAML App for Airwatch</h2>

<h3 id="saml-integration">SAML Integration</h3>

<p>Create a custom SAML Application in Okta.</p>

<p><img src="https://andrewdoering.org/blog/wp-content/uploads/2019/11/image-11-1024x489.png" alt="" /></p>

<p>Attach a photo if you would like, however, this application will mainly be hidden in the application dashboard. Go ahead and click next.</p>

<p>Below you will see a heavily redacted SAML setup. Sorry, but as these are all private links, I can’t post them. However, I have</p>

<p><img src="https://andrewdoering.org/blog/wp-content/uploads/2019/11/image-12-1024x767.png" alt="" /></p>

<p>However, you will see a modified version of the links below where you can change the wording that is in all capital letters.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;code&gt;Single Sign On URL: https://YOURDSSERVERHERE.awmdm.com/IdentityService/SAML/AssertionService.ashx?binding=HttpPost
Requestable SSO URLs, Index
https://YOURDSSERVERHERE.awmdm.com/IdentityService/SAML/AssertionService.ashx, 2
https://YOURDSSERVERHERE.awmdm.com/MyDevice/SAML/AssertionService.ashx, 5
https://YOURDSSERVERHERE.awmdm.com/DeviceManagement/SAML/AssertionService.ashx, 8
https://YOURCNSERVERHERE.awmdm.com/AirWatch/SAML/AssertionService.ashx, 11
https://YOURDSSERVERHERE.awmdm.com/Catalog/SAML/AssertionService.ashx, 14
Audience URI: SOMETHINGHERE


Attribute Statements
Name, NameFormat, Value
uid, Unspecified, user.login
objectGUID, Unspecified, user.AD_ObjectGUID
uniqueIdentifier, Unspecified, user.getInternalProperty("id")&lt;/code&gt;
</code></pre></div></div>

<p>You might be curious about the last piece here. This is a pretty way to use the Okta Expression Language to get the uniqueidentifier property that we were using previously as a way to send the string without it being an visible attribute to the user.</p>

<p>Download the metadata file that is generated.</p>

<h3 id="sdp-bookmark-application">sDP Bookmark Application</h3>

<p>Becuase Airwatch in this way only provides SAML when initiated from the software layer. Because of this, we will be creating a bookmark application to directly go to the URL that allows for SAML login provided by the Group ID within the instance.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;code&gt;https://YOURCNSERVERHERE.awmdm.com/AirWatch/Login?GID=YOURGROUPIDHERE&lt;/code&gt;
</code></pre></div></div>

<p>From there, simply add a photo, my recommendation would be to use this photo:<br />
https://images.app.goo.gl/FHoBaE4A912jCRmg9</p>

<h2 id="airwatch---saml-settings">Airwatch - SAML Settings</h2>

<p>Go to Enterprise Integrations &gt; Directory Services &gt; SAML. Take the Metadata file generated and upload it to the Import Identity Provider Settings area.</p>

<p><img src="https://andrewdoering.org/blog/wp-content/uploads/2019/12/image-1-1024x841.png" alt="" /></p>

<p>The fields should populate like so.</p>

<p>From here, you should be ready to go with logging into the Bookmark application you made.</p>

<h2 id="room-for-improvements">Room for Improvements</h2>

<p>There are various problems with this integration, and even when setting up with proserv, this did not come out the way I would have liked.</p>

<ul>
  <li>Airwatch &amp; Azure integration does not work/is not configured.<br />
Unfortunately, proserv was not super helpful with this in prepping for Azure integration for the future.  The only requirement that was checked on was for</li>
  <li>Our deployment was guided mainly towards macOS<br />
This causes a disparity between what we need and what we want. We requested that we setup both macOS and Windows configurations here.</li>
  <li>Airwatch’s ProServ consultants can vary wildly in knowledge regarding the application.<br />
This was the case with ours, we switched consultants three times. We required the use of multiple people to get our Okta setup working, this was multiple weeks.</li>
  <li>Groups are not usable in this integration<br />
Even with the required setup, using Airwatch’s documentation, group membership listing does not work, groups do import but no user listings will show. There is a <a href="https://wsone-uem.ideas.aha.io/ideas/UEMCP-I-291">Feature Request</a>, as well as support case open for this.</li>
  <li>After writing this, I looked up Airwatch’s documentation - it is vastly improved. It looks like the documentation can finally be used as a mechanism to implement features and integrations.</li>
</ul>

</p>
                                
                                <div id="disqus_thread"></div>
<script>

var disqus_config = function () {
this.page.url = "https://andrewdoering.org/blog/2019/05/01/airwatch-workspace-one-using-saml-and-ldap-with-okta/";  
this.page.identifier = "airwatch-workspace-one-using-saml-and-ldap-with-okta"; 
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://andrewdoering-org.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                            
                                
                            </div>
                        </div>
                    </div>
                </div>
            </div>
                
        </section>
        
        <!--   Blog-Single End  -->


        <!--   Footer Start  -->
<footer class="bg-dark">
    <div class="container">
        <div class="row py-5">
            <div class="col-lg-4">
                <h4 class="text-white mt-3 mt-lg-0">About <span class="base-color"> Me</span></h4>
                <p class="text-white pt-3 mb-0">Andrew Doering resides in San Francisco, and currently maintains a position at
                    ThousandEyes as a Senior IT Engineer. </p>
            </div>
            <div class="col-lg-4">
                <h4 class="text-white mt-3 mt-lg-0">Contact <span class="base-color">Us</span></h4>
                <ul class="list-unstyled text-white pt-2 mb-0">
                    <li class="py-1"><i class="fas fa-map-marker-alt pr-2"></i> San Francisco, CA 94109 USA</li>
                    <li class="py-1"><i class="fas fa-phone-square-alt pr-2"></i><a href="tel:+1 919-904-4396"> +1 919 904 4396</a></li>
                    <li class="py-1"><i class="fas fa-envelope pr-2"></i><a href="mailto:contact@andrewdoering">
                            contact@andrewdoering.org</a></li>
                </ul>
            </div>
            <div class="col-lg-4">
                <h4 class="text-white mt-3 mt-lg-0">My <span class="base-color">Socials</span></h4>
                <ul class="list-unstyled text-white socials pt-2 mb-0">
                    <li class="py-1"><a class="text-white link-hover" href="https://www.facebook.com/and.doe"><i class="fab fa-facebook-f pr-2" aria-hidden="true"></i>
                            Facebook</a></li>
                    <li class="py-1"><a class="text-white link-hover" href="https://www.linkedin.com/in/andrewdoering"><i class="fab fa-linkedin pr-2"
                                aria-hidden="true"></i> LinkedIn</a></li>
                    <li class="py-1"><a class="text-white link-hover" href="https://www.github.com/delize"><i class="fab fa-github pr-1" aria-hidden="true"></i>
                            Github</a></li>
                    <li class="py-1"><a class="text-white link-hover" href="https://www.instagram.com/dolos01"><i class="fab fa-instagram pr-2" aria-hidden="true"></i>
                            Instagram</a></li>
                    <li class="py-1"><a class="text-white link-hover" href="skype:andrew-doering"><i class="fab fa-skype pr-2" aria-hidden="true"></i> andrew-doering</a>
                    </li>
                    <li class="py-1"><a class="text-white link-hover" href="https://www.macadmins.org/"><i class="fab fa-slack pr-2" aria-hidden="true"></i> @heimdall</a>
                    </li>
                </ul>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-12 border-top pb-5">
                <p class="mt-3 mb-0 text-white d-lg-inline-block text-center">Copyright © 2020</p>
                <a href="javascript:void(0);" class="mt-4 mt-lg-3 mb-0 text-white back-to-top d-block d-lg-inline-block float-lg-right text-center">Back To Top</a>
            </div>
        </div>
    </div>
</footer>
<!--   Footer End  -->
        <!--  JavaScripts  -->
<script src=/assets/js/jquery-3.4.1.min.js></script>
<!--  Bootstrap Js  -->
<!-- <script src="assets/js/bootstrap.js"></script> -->
<script src=/assets/js/bootstrap.min.js></script>
<!--  Easing Js  -->
<script src=/assets/js/jquery.easing.min.js></script>
<!--  Isotope Js  -->
<script src=/assets/js/slyslider.js></script>
<!--  Pop UP JS Js  -->
<script src=/assets/js/jquery.magnific-popup.min.js></script>
<!--  Owl carousel Js  -->
<script src=/assets/js/owl.carousel.min.js></script>
<!--  Wow Js  -->
<script src=/assets/js/wow.min.js></script>
<!--  Typed Js  -->
<script src=/assets/js/typed.js></script>
<!--  Custom JS  -->
<script src=/assets/js/uone.js></script>


    </body>
</html>